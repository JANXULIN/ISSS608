---
title: "take home exercise 3"
author: "Xu Lin"
date: "Feb 11, 2024"
date-modified: "last-modified"
execute: 
  eval: true
  echo: true
  warning: false
editor: visual
---

# Background 
 As we know Singapore is situated near the equator and it has a typically tropical climate. It has 2 two monsoon seasons, one is Northeast Monsoon(December to early March); the other is Southwest Monsoon(une to September). In this task, we will choose December to analysis the temperature variation.

# Purpose 
Daily mean temperatures are projected to increase by 1.4 to 4.6, while annual mean temperatures rose at an average rate of 0.25 per decade.
We want to find out the reasons. 

```{r}
pacman::p_load(tidyverse, ggrepel, patchwork, 
               ggthemes, hrbrthemes,
               tidyverse, ggdist, ggridges, colorspace)
```

# Import data 
I choose the Changi station, December 1983, 1993, 2003, 2013, 2023' temperature data by grouping the data manually. R can not read the degree, so I move it out.
```{r}
TEMData <- read_csv("data/DEC1983-2023TEM.csv") 
```

```{r}
glimpse(TEMData)
```

# Data descripition 
Ridgeline plot(also known as Joyplot) is a method to display the distribution of a numeric value for several groups. We use this method to display the December of 1983, 1993, 2003, 2013, 2023's daily mean temperature.

```{r}
ggplot(data = TEMData, 
       aes(x = `Mean Temperature`, y = as.factor(Year), 
           fill = after_stat(x))) + 
    geom_density_ridges_gradient(
    scale = 3,
    rel_min_height = 0.01) +
  scale_fill_viridis_c(name = "Temp (Â°C)",
                       option = "C") +
  scale_x_continuous(
    name = "Mean Temperature",
    expand = c(0, 0)
  ) +
  scale_y_discrete(
    expand = expansion(add = c(0.2, 2.6))
  ) +
  theme_ridges() +
  labs(title = "Dec Temperature Distribution by Year",
    y = "Year")
```

```{r}
ggplot(TEMData,
       aes(x = `Mean Temperature`, y = as.factor(Year), 
           fill = 0.5 - abs(0.5-stat(ecdf)))) +
  stat_density_ridges(geom = "density_ridges_gradient", 
                      calc_ecdf = TRUE) +
  scale_fill_viridis_c(name = "Tail probability",
                       direction = -1) +
  theme_ridges()+
  labs(title = "Dec Temperature Distribution by Year",
    y = "Year")
```

```{r}
ggplot(TEMData,
       aes(x = `Mean Temperature`, y = as.factor(Year),
           fill = factor(stat(quantile))
           )) +
  stat_density_ridges(
    geom = "density_ridges_gradient",
    calc_ecdf = TRUE, 
    quantiles = 4,
    quantile_lines = TRUE) +
  scale_fill_viridis_d(name = "Quartiles") +
  theme_ridges() +
  labs(title = "Dec Temperature Distribution by Year",
    y = "Year")
```

```{r}
ggplot(TEMData,
       aes(x = `Mean Temperature`, y = as.factor(Year), 
           fill = factor(stat(quantile))
           )) +
  stat_density_ridges(
    geom = "density_ridges_gradient",
    calc_ecdf = TRUE, 
    quantiles = c(0.025, 0.975)
    ) +
  scale_fill_manual(
    name = "Probability",
    values = c("#FF0000A0", "#A0A0A0A0", "#0000FFA0"),
    labels = c("(0, 0.025]", "(0.025, 0.975]", "(0.975, 1]")
  ) +
  theme_ridges()+
  labs(title = "Dec Temperature Distribution by Year",
    y = "Year")
```

```{r}
ggplot(TEMData,
       aes(x = as.factor(Year), y = `Mean Temperature`)) +
  stat_halfeye(adjust = 0.5,
               justification = -0.2,
               .width = 0,
               point_colour = NA) +
  labs(title = "Dec Temperature Distribution by Year",
    x = "Year")
```

```{r}
ggplot(TEMData,
       aes(x = as.factor(Year), y = `Mean Temperature`)) +
  stat_halfeye(adjust = 0.5,
               justification = -0.2,
               .width = 0,
               point_colour = NA) +
  geom_boxplot(width = .20,
               outlier.shape = NA) +
  labs(title = "Dec Temperature Distribution by Year",
    x = "Year")
```

```{r}
ggplot(TEMData,
       aes(x = as.factor(Year), y = `Mean Temperature`)) +
  stat_halfeye(adjust = 0.5,
               justification = -0.2,
               .width = 0,
               point_colour = NA) +
  geom_boxplot(width = .20,
               outlier.shape = NA) +
  stat_dots(side = "left", 
            justification = 1.2, 
            binwidth = .5,
            dotsize = 0.1)+
  labs(title = "Dec Temperature Distribution by Year",
    x = "Year")
```

```{r}
ggplot(TEMData,
       aes(x = as.factor(Year), y = `Mean Temperature`)) +
  stat_halfeye(adjust = 0.5,
               justification = -0.2,
               .width = 0,
               point_colour = NA) +
  geom_boxplot(width = .20,
               outlier.shape = NA) +
  stat_dots(side = "left", 
            justification = 1.2, 
            binwidth = .5,
            dotsize = 0.1) +
  coord_flip() +
  theme_economist()+
  labs(title = "Dec Temperature Distribution by Year",
    x = "Year")
```
























































